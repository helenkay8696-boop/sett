<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>丰园结算 - Premium Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts: Inter & Outfit -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i data-lucide="truck"></i>
                    <span style="font-weight: 700; font-size: 1.1rem; letter-spacing: -0.5px;">丰源货主管理</span>
                </div>
            </div>
            <ul class="nav-list">
                <li class="nav-item" data-title="工作台"><i data-lucide="home"></i><span>工作台</span></li>

                <li class="nav-item" data-title="业务"><i data-lucide="briefcase"></i><span>业务</span></li>

                <li class="nav-item" data-title="报价"><i data-lucide="calculator"></i><span>报价</span></li>

                <li class="nav-item active" data-title="结算"><i data-lucide="layout-grid"></i><span>结算</span></li>
                <li class="nav-item" data-title="财务"><i data-lucide="banknote"></i><span>财务</span></li>
                <li class="nav-item" data-title="报表"><i data-lucide="bar-chart-3"></i><span>报表</span></li>
                <li class="nav-item" data-title="客商"><i data-lucide="users"></i><span>客商</span></li>
                <li class="nav-item" data-title="档案"><i data-lucide="folder-open"></i><span>档案</span></li>
                <li class="nav-item" data-title="用户"><i data-lucide="user-circle"></i><span>用户</span></li>
                <li class="nav-item" data-title="系统"><i data-lucide="settings"></i><span>系统</span></li>
            </ul>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Global Search Header (Independent of Nav) -->
            <div class="top-banner">
                <div class="search-header">
                    <div class="brand">丰源</div>
                    <div class="divider-v"></div>
                    <div class="search-group">
                        <div class="dropdown" id="search-dropdown">
                            <span id="selected-type">工作单号</span>
                            <i data-lucide="chevron-down"></i>
                            <div class="dropdown-menu" id="dropdown-menu">
                                <div class="dropdown-item active" data-value="工作单号">工作单号</div>
                                <div class="dropdown-item" data-value="配载单号">配载单号</div>
                            </div>
                        </div>
                        <input type="text" placeholder="工作单号/配载单号">
                        <button class="search-btn">
                            <i data-lucide="search"></i>
                        </button>
                    </div>
                    <div class="button-group">
                        <button class="action-btn">查询轨迹</button>
                        <button class="action-btn">接收账单</button>
                    </div>
                </div>
            </div>

            <!-- Dynamic Tabs Bar -->
            <div class="tabs-bar" id="tabs-bar" style="display: none;">
                <div class="tabs-list" id="tabs-list">
                    <!-- Tabs injected here -->
                </div>
            </div>

            <!-- Page Body with Overlay Navigation -->
            <div class="page-layout">
                <div class="menu-mask" id="menu-mask"></div>
                <aside class="sub-sidebar" id="sub-sidebar">
                    <div class="secondary-nav" id="secondary-content">
                        <!-- Dynamic Content will be injected here -->
                    </div>
                </aside>
                <div class="page-content">
                    <!-- Future main page content -->
                </div>
            </div>
        </main>
    </div>
    <!-- Statement Modal -->
    <div class="modal-overlay" id="statement-modal">
        <div class="modal-container">
            <div class="modal-header">
                <span>对账单</span>
                <div class="modal-actions">
                    <i data-lucide="square" class="header-icon"></i>
                    <i data-lucide="x" class="header-icon" id="close-modal"></i>
                </div>
            </div>

            <div class="modal-content">
                <!-- Filter Section -->
                <div class="modal-filter-bar">
                    <div class="filter-row">
                        <div class="filter-item">
                            <label>结算单位</label>
                            <div class="select-box" style="width: 250px;">
                                <span>请选择</span>
                                <i data-lucide="chevron-down"></i>
                            </div>
                        </div>
                        <div class="filter-item flex-grow">
                            <input type="text" placeholder="请输入工作单号/配载单号" style="width: 100%;">
                        </div>
                        <button class="primary-btn search-btn-main">
                            <i data-lucide="search"></i> 查询
                        </button>
                        <button class="ghost-btn" id="toggle-filter-btn">更多(2) <i
                                data-lucide="chevron-down"></i></button>
                        <button class="accent-btn">
                            <i data-lucide="plus-circle"></i> 创建账单
                        </button>
                        <i data-lucide="settings" class="settings-icon"></i>
                    </div>

                    <div id="expandable-filter-area">
                        <div class="filter-row">
                            <div class="filter-item">
                                <div class="select-box-inline" style="width: 100px;">计费日期 <i
                                        data-lucide="chevron-down"></i>
                                </div>
                                <input type="date" value="2025-01-01">
                                <span>-</span>
                                <input type="date" value="2025-12-31">
                            </div>
                            <div class="filter-item">
                                <div class="select-box-inline relative-container"
                                    style="width: 100px; -webkit-user-select: none; user-select: none;">
                                    <span id="work-order-type-val">工作单号</span>
                                    <i data-lucide="chevron-down"></i>
                                    <div class="dropdown-menu-custom hidden" id="work-order-type-menu">
                                        <div class="dropdown-item-custom"
                                            onclick="selectOption('work-order-type-val', '工作单号')">工作单号</div>
                                        <div class="dropdown-item-custom"
                                            onclick="selectOption('work-order-type-val', '账单号')">账单号</div>
                                    </div>
                                </div>
                                <input type="text" placeholder="请输入">
                            </div>
                            <div class="filter-item">
                                <label>单笔费用待销余额</label>
                                <div class="select-box" style="width: 80px;">
                                    <span>!=</span>
                                    <i data-lucide="chevron-down"></i>
                                </div>
                                <input type="text" value="0" style="width: 100px; margin-left: 8px;">
                            </div>
                        </div>

                        <div class="filter-row">
                            <div class="filter-item">
                                <label>费用项目</label>
                                <div class="select-box">
                                    <span>请选择</span>
                                    <i data-lucide="chevron-down"></i>
                                </div>
                            </div>
                            <div class="filter-item">
                                <label>费用类型</label>
                                <div class="select-box relative-container"
                                    style="-webkit-user-select: none; user-select: none;">
                                    <span id="expense-type-val">请选择</span>
                                    <i data-lucide="chevron-down"></i>
                                    <div class="dropdown-menu-custom hidden" id="expense-type-menu">
                                        <div class="dropdown-item-custom"
                                            onclick="selectOption('expense-type-val', '应收')">
                                            应收</div>
                                        <div class="dropdown-item-custom"
                                            onclick="selectOption('expense-type-val', '应付')">
                                            应付</div>
                                    </div>
                                </div>
                            </div>
                            <div class="filter-item">
                                <label>运输公司</label>
                                <div class="select-box">
                                    <span>请选择</span>
                                    <i data-lucide="chevron-down"></i>
                                </div>
                            </div>
                            <div class="filter-item">
                                <label>司机姓名</label>
                                <div class="select-box">
                                    <span>请选择</span>
                                    <i data-lucide="chevron-down"></i>
                                </div>
                            </div>
                            <div class="filter-item">
                                <label>车牌号</label>
                                <div class="select-box">
                                    <span>请选择</span>
                                    <i data-lucide="chevron-down"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Table Section -->
                <div class="modal-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">#</th>
                                <th style="width: 40px;"><input type="checkbox"></th>
                                <th>工作单号</th>
                                <th>账单号</th>
                                <th>结算单位</th>
                                <th>计费日期</th>
                                <th>费用项</th>
                                <th>币制</th>
                                <th>数量</th>
                                <th>单价</th>
                                <th>税率</th>
                                <th>原币金额</th>
                                <th>对账金额</th>
                                <th>折合金额</th>
                                <th>账单金额</th>
                                <th>未核销</th>
                                <th>所属公司</th>
                                <th>签收日期</th>
                                <th>运输公司</th>
                                <th>司机姓名</th>
                                <th>车牌号</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Empty State -->
                        </tbody>
                    </table>
                    <div class="table-empty-state">
                        <img src="https://img.icons8.com/ios/100/94a3b8/search--v1.png" alt="no data"
                            style="width: 64px; opacity: 0.5;">
                        <p>暂无数据</p>
                        <span style="font-size: 0.7rem;">No data</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Pre-write-off Modal -->
    <div class="modal-overlay" id="pre-write-off-modal">
        <div class="modal-container" style="max-width: 1000px; height: auto; max-height: 85vh;">
            <div class="modal-header">
                <span>提交预销账</span>
                <div class="modal-actions">
                    <i data-lucide="x" class="header-icon" onclick="closePreWriteOffModal()"></i>
                </div>
            </div>
            <div class="modal-content" style="padding: 20px;">
                <!-- Top Info Row -->
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; font-size: 13px; color: #475569;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-weight: 500;">结算单位：</span>
                        <span>663333</span>
                    </div>
                    <div
                        style="display: flex; align-items: center; gap: 8px; flex: 1; max-width: 500px; margin-left: 40px;">
                        <span style="font-weight: 500; white-space: nowrap;">备注：</span>
                        <input type="text" placeholder="请输入"
                            style="flex: 1; height: 32px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 0 10px; font-size: 13px;">
                    </div>
                </div>

                <!-- Payment Method Row -->
                <div
                    style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px; font-size: 13px; color: #475569;">
                    <span style="font-weight: 500;">客户付款：</span>
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                            <input type="radio" name="payment-type" checked> 原币付款
                        </label>
                        <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                            <input type="radio" name="payment-type"> 折合付款
                        </label>
                    </div>
                </div>

                <!-- Table Section -->
                <div style="border: 1px solid #e2e8f0; border-radius: 4px; overflow: hidden; margin-bottom: 20px;">
                    <div style="overflow-x: auto;">
                        <table class="statement-table"
                            style="width: 100%; border-collapse: collapse; font-size: 12px; min-width: 900px;">
                            <thead>
                                <tr style="background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
                                    <th style="width: 40px; text-align: center; padding: 10px;"><input type="checkbox">
                                    </th>
                                    <th style="width: 40px; padding: 10px;"></th>
                                    <th style="padding: 10px; text-align: left;">账单号</th>
                                    <th style="padding: 10px; text-align: left;">账单日期</th>
                                    <th style="padding: 10px; text-align: left;">工作单号</th>
                                    <th style="padding: 10px; text-align: left;">费用</th>
                                    <th style="padding: 10px; text-align: left;">原币</th>
                                    <th style="padding: 10px; text-align: left;">原币待销金额</th>
                                    <th style="padding: 10px; text-align: left;">折算符</th>
                                    <th style="padding: 10px; text-align: left;">兑换率</th>
                                    <th style="padding: 10px; text-align: left;">收款币制</th>
                                    <th style="padding: 10px; text-align: left;">收款金额</th>
                                    <th style="padding: 10px; text-align: left;">原币销账金额</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="text-align: center; padding: 10px;"><input type="checkbox"></td>
                                    <td style="padding: 10px;"></td>
                                    <td style="padding: 10px;">BILL20231201</td>
                                    <td style="padding: 10px;">2023-12-10</td>
                                    <td style="padding: 10px;">OTH202312009</td>
                                    <td style="padding: 10px;">运费</td>
                                    <td style="padding: 10px;">USD</td>
                                    <td style="padding: 10px;">500.00</td>
                                    <td style="padding: 10px;">*</td>
                                    <td style="padding: 10px;">7.12</td>
                                    <td style="padding: 10px;">CNY</td>
                                    <td style="padding: 10px;">3560.00</td>
                                    <td style="padding: 10px;">500.00</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr style="background: #f8fafc; font-weight: 600; color: #1e293b;">
                                    <td colspan="6" style="padding: 12px 10px; text-align: right;">已选合计</td>
                                    <td style="padding: 12px 10px;">USD</td>
                                    <td style="padding: 12px 10px;">500.00</td>
                                    <td style="padding: 12px 10px;"></td>
                                    <td style="padding: 12px 10px;"></td>
                                    <td style="padding: 12px 10px;">CNY</td>
                                    <td style="padding: 12px 10px;">3560.00</td>
                                    <td style="padding: 12px 10px;">500.00</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <!-- Additional Info Row -->
                    <div
                        style="padding: 16px; display: flex; align-items: center; gap: 48px; background: #fff; border-top: 1px solid #f1f5f9;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 13px; color: #475569;">CNY收款账户:</span>
                            <div class="select-box" style="width: 300px; height: 32px;">
                                <span style="color: #cbd5e1;">请选择</span>
                                <i data-lucide="chevron-down"></i>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 13px; color: #475569;">CNY水单:</span>
                            <a href="#"
                                style="color: #3b82f6; font-size: 13px; text-decoration: none; display: flex; align-items: center; gap: 4px; font-weight: 500;">
                                <i data-lucide="paperclip" style="width: 14px; height: 14px;"></i> 附件
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Footer Actions -->
                <div style="margin-top: 20px; display: flex; justify-content: flex-end; padding-top: 16px;">
                    <button class="primary-btn"
                        style="height: 34px; padding: 0 20px; display: flex; align-items: center; gap: 8px; background: #3b82f6; border: none;"
                        onclick="closePreWriteOffModal()">
                        <i data-lucide="save" style="width: 16px; height: 16px;"></i> 提交
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoicing Expense Config Modal -->
    <div class="modal-overlay" id="invoice-expense-modal">
        <div class="modal-container" style="max-width: 800px; height: auto; max-height: 90vh; background: #f8fafc;">
            <div class="modal-header" style="background: white; border-bottom: 1px solid #e2e8f0; padding: 12px 20px;">
                <span style="font-weight: 600; color: #334155; font-size: 1rem;">新增</span>
                <div class="modal-actions">
                    <i data-lucide="x" class="header-icon" id="close-expense-modal" onclick="closeInvoiceExpenseModal()"
                        style="cursor: pointer; color: #64748b;"></i>
                </div>
            </div>

            <div class="modal-content" style="padding: 20px; background: white;">
                <!-- Form Row 1 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label style="font-size: 0.85rem; color: #475569; white-space: nowrap;"><span
                                style="color: #ef4444;">*</span> 税收分类</label>
                        <div
                            style="display: flex; gap: 0; flex-grow: 1; border: 1px solid #ffccd5; border-radius: 4px; overflow: hidden; background: #fff5f6;">
                            <input type="text" id="invoice-tax-code" placeholder="税收分类编码"
                                style="width: 40%; border: none; background: transparent; height: 32px; padding: 0 10px; font-size: 0.85rem; border-right: 1px solid #ffccd5;">
                            <input type="text" id="invoice-tax-name" placeholder="税收分类名称"
                                style="width: 60%; border: none; background: transparent; height: 32px; padding: 0 10px; font-size: 0.85rem;">
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label style="font-size: 0.85rem; color: #475569; white-space: nowrap;"><span
                                style="color: #ef4444;">*</span> 货物或应税劳务、服务名称</label>
                        <input type="text" id="invoice-service-name" placeholder="请输入"
                            style="flex-grow: 1; height: 32px; border: 1px solid #ffccd5; border-radius: 4px; padding: 0 10px; font-size: 0.85rem; background: #fff5f6;">
                    </div>
                </div>

                <!-- Form Row 2 -->
                <div style="display: flex; align-items: center; gap: 48px; margin-bottom: 24px;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label style="font-size: 0.85rem; color: #475569; white-space: nowrap;"><span
                                style="color: #ef4444;">*</span> 税率</label>
                        <div
                            style="display: flex; align-items: center; width: 150px; border: 1px solid #ffccd5; background: #fff5f6; border-radius: 4px; padding: 0 8px;">
                            <input type="text" id="invoice-tax-rate" placeholder="请输入"
                                style="width: 100%; border: none; background: transparent; height: 32px; text-align: center; font-size: 0.85rem;">
                            <span style="color: #64748b; font-size: 0.85rem;">%</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <span style="font-size: 0.85rem; color: #475569;">是否免税</span>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <label
                                style="display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 0.85rem; color: #334155;">
                                <input type="radio" name="tax-free" value="否" checked> 否
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 0.85rem; color: #334155;">
                                <input type="radio" name="tax-free" value="是"> 是
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Table Section -->
                <div style="border-top: 1px solid #f1f5f9; padding-top: 16px;">
                    <a href="#"
                        style="display: flex; align-items: center; gap: 6px; color: #3b82f6; text-decoration: none; font-size: 0.85rem; font-weight: 500; margin-bottom: 12px; width: fit-content; background: #eff6ff; padding: 6px 12px; border-radius: 4px;">
                        <i data-lucide="plus-circle" style="width: 16px; height: 16px;"></i> 选择费用项目
                    </a>

                    <div style="border: 1px solid #e2e8f0; border-radius: 4px; min-height: 400px; background: white;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
                                    <th
                                        style="padding: 10px; font-size: 0.85rem; color: #64748b; font-weight: 500; text-align: center; border-right: 1px solid #e2e8f0; width: 100px;">
                                        代码</th>
                                    <th
                                        style="padding: 10px; font-size: 0.85rem; color: #64748b; font-weight: 500; text-align: center; border-right: 1px solid #e2e8f0;">
                                        费用名称</th>
                                    <th
                                        style="padding: 10px; font-size: 0.85rem; color: #64748b; font-weight: 500; text-align: center; width: 100px;">
                                        操作</th>
                                </tr>
                            </thead>
                            <tbody id="invoice-expense-items-body">
                                <tr>
                                    <td colspan="3" style="padding: 100px 0; text-align: center;">
                                        <div
                                            style="display: flex; flex-direction: column; align-items: center; gap: 12px;">
                                            <div style="position: relative; width: 100px; height: 64px;">
                                                <i data-lucide="search"
                                                    style="width: 48px; height: 48px; color: #cbd5e1; opacity: 0.5;"></i>
                                                <div
                                                    style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); color: #94a3b8; font-size: 0.75rem;">
                                                    No data</div>
                                            </div>
                                            <span style="color: #94a3b8; font-size: 0.85rem;">暂无数据</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div style="margin-top: 24px; display: flex; justify-content: flex-end;">
                    <button class="primary-btn" id="save-invoice-expense-btn" onclick="saveInvoiceExpenseConfig()"
                        style="height: 34px; padding: 0 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; display: flex; align-items: center; gap: 8px; font-size: 0.85rem; cursor: pointer;">
                        <i data-lucide="save" style="width: 16px; height: 16px;"></i> 保存
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        lucide.createIcons();
    </script>
</body>

</html>